import{s as J,r as K,o as Q,n as j}from"../chunks/scheduler.hyw8iwdn.js";import{S as X,i as Y,e as b,s as C,c as v,a as E,d,f as H,l as i,g as F,h,z as V,q as I,m as N,n as Z,k as S,o as $,t as x,b as ee,r as se,u as te,v as ne,w as oe,p as re}from"../chunks/index.C4qMneLH.js";import{b as ae,c as le,s as A,g as ie,r as ue,L as ce}from"../chunks/fetchClient.VWr9vY9a.js";import{g as G}from"../chunks/entry.DZMyNYA3.js";function _e(o){let e;return{c(){e=x("Login")},l(s){e=ee(s,"Login")},m(s,t){F(s,e,t)},i:j,o:j,d(s){s&&d(e)}}}function fe(o){let e,s;return e=new ce({props:{isSmall:!0,isWhite:!0}}),{c(){se(e.$$.fragment)},l(t){te(e.$$.fragment,t)},m(t,r){ne(e,t,r),s=!0},i(t){s||(S(e.$$.fragment,t),s=!0)},o(t){N(e.$$.fragment,t),s=!1},d(t){oe(e,t)}}}function pe(o){let e;return{c(){e=b("div"),this.h()},l(s){e=v(s,"DIV",{class:!0}),E(e).forEach(d),this.h()},h(){i(e,"class","login__spacer svelte-1niap0b")},m(s,t){F(s,e,t)},d(s){s&&d(e)}}}function de(o){let e,s='<p class="svelte-1niap0b">Error occurred on login, try again.</p>';return{c(){e=b("div"),e.innerHTML=s,this.h()},l(t){e=v(t,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-15erdst"&&(e.innerHTML=s),this.h()},h(){i(e,"class","login__error svelte-1niap0b")},m(t,r){F(t,e,r)},d(t){t&&d(e)}}}function me(o){let e,s,t,r,g,y,p,l,D,L,_,c,f,P,u,w,M;const q=[fe,_e],T=[];function O(n,a){return n[3]?0:1}c=O(o),f=T[c]=q[c](o);function W(n,a){return n[4]?de:pe}let U=W(o),m=U(o);return{c(){e=b("div"),s=b("form"),t=b("div"),r=b("input"),y=C(),p=b("div"),l=b("input"),L=C(),_=b("button"),f.c(),P=C(),m.c(),this.h()},l(n){e=v(n,"DIV",{class:!0});var a=E(e);s=v(a,"FORM",{class:!0});var k=E(s);t=v(k,"DIV",{class:!0});var z=E(t);r=v(z,"INPUT",{name:!0,placeholder:!0,class:!0}),z.forEach(d),y=H(k),p=v(k,"DIV",{class:!0});var B=E(p);l=v(B,"INPUT",{name:!0,placeholder:!0,type:!0,class:!0}),B.forEach(d),k.forEach(d),L=H(a),_=v(a,"BUTTON",{class:!0});var R=E(_);f.l(R),R.forEach(d),P=H(a),m.l(a),a.forEach(d),this.h()},h(){i(r,"name","username"),i(r,"placeholder","Username"),i(r,"class","input svelte-1niap0b"),r.disabled=o[3],i(t,"class",g="login__input "+(o[1]?"--focused":"")+" svelte-1niap0b"),i(l,"name","password"),i(l,"placeholder","Password"),i(l,"type","password"),i(l,"class","input svelte-1niap0b"),l.disabled=o[3],i(p,"class",D="login__input "+(o[2]?"--focused":"")+" svelte-1niap0b"),i(s,"class","login__form svelte-1niap0b"),i(_,"class","button login__submit svelte-1niap0b"),_.disabled=o[3],i(e,"class","login svelte-1niap0b")},m(n,a){F(n,e,a),h(e,s),h(s,t),h(t,r),V(r,o[0].username),h(s,y),h(s,p),h(p,l),V(l,o[0].password),h(e,L),h(e,_),T[c].m(_,null),h(e,P),m.m(e,null),u=!0,w||(M=[I(r,"input",o[6]),I(r,"focusin",o[7]),I(r,"focusout",o[8]),I(l,"input",o[9]),I(l,"focusin",o[10]),I(l,"focusout",o[11]),I(_,"click",o[5])],w=!0)},p(n,[a]){(!u||a&8)&&(r.disabled=n[3]),a&1&&r.value!==n[0].username&&V(r,n[0].username),(!u||a&2&&g!==(g="login__input "+(n[1]?"--focused":"")+" svelte-1niap0b"))&&i(t,"class",g),(!u||a&8)&&(l.disabled=n[3]),a&1&&l.value!==n[0].password&&V(l,n[0].password),(!u||a&4&&D!==(D="login__input "+(n[2]?"--focused":"")+" svelte-1niap0b"))&&i(p,"class",D);let k=c;c=O(n),c!==k&&($(),N(T[k],1,1,()=>{T[k]=null}),Z(),f=T[c],f||(f=T[c]=q[c](n),f.c()),S(f,1),f.m(_,null)),(!u||a&8)&&(_.disabled=n[3]),U!==(U=W(n))&&(m.d(1),m=U(n),m&&(m.c(),m.m(e,null)))},i(n){u||(S(f),u=!0)},o(n){N(f),u=!1},d(n){n&&d(e),T[c].d(),m.d(),w=!1,K(M)}}}function he(o,e,s){let t={username:"",password:""},r=!1,g=!1,y=!1,p=!1;const l=async()=>{s(3,y=!0),s(4,p=!1);try{const w=(await ae("/login",t)).data,M=w.expiry*1e3;le({token:w.token,expiry:new Date(M)}),A.set({token:w.token,expiry:new Date(M)}),setTimeout(()=>{G("/dashboard")},500)}catch{s(3,y=!1),s(4,p=!0)}};Q(()=>{const u=ie();u.token&&u.expiry>new Date?G("/dashboard"):(ue(),A.set({token:"",expiry:new Date}))});function D(){t.username=this.value,s(0,t)}const L=()=>s(1,r=!0),_=()=>s(1,r=!1);function c(){t.password=this.value,s(0,t)}return[t,r,g,y,p,l,D,L,_,c,()=>s(2,g=!0),()=>s(2,g=!1)]}class ye extends X{constructor(e){super(),Y(this,e,he,me,J,{})}}export{ye as component};
